System.registerDynamic("components/app.css!github:systemjs/plugin-css@0.1.32/css.js",[],!1,function($__require,$__exports,$__module){var _retrieveGlobal=System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function($__global){}(this),_retrieveGlobal()}),System.register("common/services/grid/grid.js",["angular","angular-ui-grid","angular-ui-grid/ui-grid.css!"],function(_export,_context){"use strict";var angular,module;return{setters:[function(_angular){angular=_angular.default},function(_angularUiGrid){},function(_angularUiGridUiGridCss){}],execute:function(){module=angular.module("projectX.grid",["ui.grid","ui.grid.autoResize","ui.grid.selection","ui.grid.resizeColumns","ui.grid.pagination"]),_export("default",module.name)}}}),System.register("common/directives/slider/index.js",["angularjs-slider","./slider.less!"],function(_export,_context){"use strict";var angularSlider;return{setters:[function(_angularjsSlider){angularSlider=_angularjsSlider.default},function(_sliderLess){}],execute:function(){_export("default",angularSlider)}}}),System.register("components/scatter/scatter.html!github:systemjs/plugin-text@0.0.9/text.js",[],function(_export,_context){"use strict";var __useDefault;return{setters:[],execute:function(){_export("__useDefault",__useDefault=!0),_export("__useDefault",__useDefault),_export("default",'<script type="text/ng-template" id="bootstrap/match-multiple.tpl.html">\n  <span class="ui-select-match">\n    <span ng-repeat="$item in $select.selected track by $index">\n      <span\n        class="ui-select-match-item btn btn-default btn-xs"\n        tabindex="-1"\n        type="button"\n        ng-disabled="$select.disabled"\n        ng-click="$selectMultiple.activeMatchIndex = $index;"\n        ng-class="{\'select-locked\':$select.isLocked(this, $index)}"\n        ui-select-sort="$select.selected">\n          <span class="close ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&nbsp;&times;</span>\n          <span uis-transclude-append></span>\n      </span>\n    </span>\n  </span>\n</script>\n\n<div id="view" ng-intro-options="$ctrl.introOptions" ng-intro-method="CallMe" ng-intro-autostart="false">\n  <div id="charts" class="container-fluid deiva-canvas">\n    <div class="row">\n      <form>\n        <uib-accordion class="col-md-3" close-others="false">\n          <div id="data-set" uib-accordion-group class="panel-default" is-open="$ctrl.uiState.dataset">\n            <uib-accordion-heading>\n              Dataset <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': $ctrl.uiState.dataset, \'glyphicon-chevron-right\': !$ctrl.uiState.dataset}"></i>\n            </uib-accordion-heading>\n            <ui-select id="data-set"\n              theme="bootstrap"\n              ng-model="$ctrl.selectedData"\n              title="Choose an experiment"\n              ng-change="$ctrl.loadDataset($ctrl.selectedData)">\n              <ui-select-match placeholder="Enter an experiment...">\n                <small>{{$select.selected.name}}</small>\n              </ui-select-match>\n              <ui-select-choices repeat="value in $ctrl.experimentList | filter: { name: $select.search }">\n                <small ng-bind-html="value.name | highlight: $select.search"></small>\n              </ui-select-choices>\n            </ui-select>\n            <br />\n            <div class="">\n              <div class="file-dropzone" file-dropzone="text/plain,text/csv,text/tab-separated-values" data-max-file-size="30" dropped="$ctrl.dropped(file)">\n                <label id="data-drop" class="col-xs-12 btn btn-primary btn-sm btn-file">\n                  Select or drop your data here\n                  <input type="file" on-read-file="$ctrl.dropped(file)" accept="text/plain,text/csv,text/tab-separated-values" data-max-file-size="30" style="display: none;" />\n                </label>\n              </div>\n            </div>\n          </div>\n          <div uib-accordion-group class="panel-default" is-open="$ctrl.uiState.locate">\n            <uib-accordion-heading>\n              Locate <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': $ctrl.uiState.locate, \'glyphicon-chevron-right\': !$ctrl.uiState.locate}"></i>\n            </uib-accordion-heading>\n            <ui-select id="gene-select"\n                multiple theme="bootstrap" paste="$ctrl.pasteSymbols" tagging-tokens="SPACE|,|/"\n                ng-model="$ctrl.geneList"\n                ng-change="$ctrl.update()">\n              <ui-select-no-choice>\n                We couldn\'t find any matches...\n              </ui-select-no-choice>\n              <ui-select-match placeholder="Select genes...">\n                <span>\n                  {{$item.symbol}}\n                  <span class="small badge symbol-badge" ng-style="{ backgroundColor: $ctrl.colorMap[$item.symbol] }">\n                    {{$item.count}}\n                    <input type="color"\n                      spectrum-colorpicker\n                      ng-model="$ctrl.colorMap[$item.symbol]"\n                      on-hide="$ctrl.update()"\n                      on-move-options="{ update : true }" />\n                  </span>\n                </span>\n              </ui-select-match>\n              <ui-select-choices repeat="gene in $ctrl.uniqGeneList | filter: $select.search | limitTo: 100 track by gene.symbol"\n                  refresh-delay="1000"\n                  ng-class="{ hide: $select.search.length < 1 }">\n                  <span ng-bind-html="gene.symbol | highlight: $select.search"></span>\n                  <span class="badge small" ng-style="{ backgroundColor: ($ctrl.colorMap[gene.symbol] || \'#777777\') }">\n                    <small ng-bind="gene.count">\n                    </small>\n                  </span>\n              </ui-select-choices>\n            </ui-select>\n            <div class="row">\n              <div class="col-xs-12">\n                <div id="gene-list-toolbar" class="btn-group btn-group-xs pull-right">\n                  <button id="clipboard-btn" class="btn btn-sm btn-default" title="Copy list to clipboard"\n                  ng-disabled="$ctrl.geneList.length === 0">\n                    <i class="fa fa-clipboard" aria-hidden="true"></i>\n                  </button>\n                  <button class="btn btn-sm btn-default" title="Clear"\n                    ng-click="$ctrl.geneList = []; $ctrl.update()"\n                    ng-disabled="$ctrl.geneList.length === 0">\n                    <i class="fa fa-times" aria-hidden="true"></i>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div id="filters" uib-accordion-group class="panel-default" is-open="$ctrl.uiState.filters">\n            <uib-accordion-heading>\n              Filters <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': $ctrl.uiState.filters, \'glyphicon-chevron-right\': !$ctrl.uiState.filters}"></i>\n            </uib-accordion-heading>\n            <div id="fc-filter" class="col-md-12 col-xs-6">\n              <label><a href ng-click="$ctrl.uiState.fccut = !$ctrl.uiState.fccut">abs. log2FoldChange &gt; {{$ctrl.plotState.fccut}}</a></label>\n              <div uib-collapse="!$ctrl.uiState.fccut">\n                <input type="number" class="form-control input-sm" ng-model="$ctrl.plotState.fccut" min="0" max="5" step="0.1" ng-change="$ctrl.update()"/>\n                <rzslider rz-slider-model="$ctrl.plotState.fccut" rz-slider-options="$ctrl.sliders.fccut"></rzslider>\n              </div>\n            </div>\n\n            <div id="fdr-filter" class="col-md-12 col-xs-6">\n              <label><a href ng-click="$ctrl.uiState.logpcut = !$ctrl.uiState.logpcut">AND log10 FDR &le; {{$ctrl.plotState.logpcut}}</a></label>\n              <div uib-collapse="!$ctrl.uiState.logpcut">\n                <input type="number" class="form-control input-sm" ng-model="$ctrl.plotState.logpcut" min="-5" max="0" step="0.1" ng-change="$ctrl.update()"/>\n                <rzslider rz-slider-model="$ctrl.plotState.logpcut" rz-slider-options="$ctrl.sliders.logpcut"></rzslider>\n              </div>\n            </div>\n\n            <div id="bm-filter" class="col-md-12 col-xs-6">\n              <label><a href ng-click="$ctrl.uiState.bmcut = !$ctrl.uiState.bmcut">AND {{$ctrl.xLabel.MA}} &gt; {{$ctrl.plotState.bmcut}}</a></label>\n              <div uib-collapse="!$ctrl.uiState.bmcut">\n                <input type="number" class="form-control input-sm" ng-model="$ctrl.plotState.bmcut" step="0.1" ng-change="$ctrl.update()"/>\n                <rzslider rz-slider-model="$ctrl.plotState.bmcut" rz-slider-options="$ctrl.sliders.bmcut"></rzslider>\n              </div>\n            </div>\n\n            <div class="row clear">\n              <div id="gene-count" class="col-md-12 text-right">\n                <label>Up: {{$ctrl.upDown[0]}}</label>\n                <label>Down: {{$ctrl.upDown[1]}}</label>\n              </div>\n            </div>\n          </div>\n          <div id="plot-options"uib-accordion-group class="panel-default" is-open="$ctrl.uiState.plot">\n            <uib-accordion-heading>\n              Plot <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': $ctrl.uiState.plot, \'glyphicon-chevron-right\': !$ctrl.uiState.plot}"></i>\n            </uib-accordion-heading>\n            <div class="col-md-12 col-xs-6">\n              <rzslider rz-slider-model="$ctrl.plotState.alpha" rz-slider-options="$ctrl.sliders.alpha"></rzslider>\n            </div>\n\n            <div id="plot-field" class="col-md-12 col-xs-6">\n              <label>Density plot:</label>\n              <input type="radio" name="hex" value="hex" checked ng-model="$ctrl.plotState.plot" ng-change="$ctrl.draw()"> Hexplot\n              <input type="radio" name="scatter" value="scatter" ng-model="$ctrl.plotState.plot" ng-change="$ctrl.draw()"> Scatterplot\n            </div>\n\n            <div id="plot-type" class="col-md-12 col-xs-6">\n              <label>Type:</label>\n              <input type="radio" name="MA" value="MA" checked ng-model="$ctrl.plotState.plotType" ng-change="$ctrl.draw()"> MA-plot\n              <input type="radio" name="Volcano" value="Volcano" ng-model="$ctrl.plotState.plotType" ng-change="$ctrl.draw()"> Volcano\n            </div>\n          </div>\n        </uib-accordion>\n      <form>\n\n      <div class="col-md-9" on-resize="$ctrl.draw()">\n        <div class="well chart-height chart-well">\n          <div id="chart-toolbar" class="btn-group btn-group-xs pull-right toolbar chart-toolbar" role="group" aria-label="toolbar">\n            <button type="button" class="btn btn-sm btn-default" ng-disabled="$ctrl.chart.brush.empty()" ng-click="$ctrl.chartAction(\'zoomExtent\')" title="zoom to selection">\n              <span class="fa-stack zoom-extent">\n                <i class="fa fa-square-o fa-stack-1x" aria-hidden="true"></i>\n                <i class="fa fa-search fa-stack-1x" aria-hidden="true"></i>\n              </span>\n            </button>\n\n            <button type="button" class="btn btn-default" ng-click="$ctrl.chartAction(\'zoomOut\')" title="zoom out">\n              <i class="fa fa-search-minus" aria-hidden="true"></i>\n            </button>\n\n            <button type="button" class="btn btn-default" ng-click="$ctrl.chartAction(\'zoomHome\')" title="zoom home">\n              <i class="fa fa-arrows-alt" aria-hidden="true"></i>\n            </button>\n          </div>\n\n          <div id="_scatter__chart" class="_scatter" file-dropzone="[text/plain,text/csv,text/tab-separated-values]" data-max-file-size="30" dropped="$ctrl.dropped(file)">\n            <div class="spinner-icon"></div>\n            <div class="drop-here">\n              Drop File Here\n            </div>\n            <div class="chart" ng-non-bindable></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div class="row">\n      <div class="col-md-12">\n        <h2>Expression <small>Showing {{$ctrl.gridOptions.data.length}} of {{$ctrl.dataState.data.length}}</small></h2>\n        <div ui-grid="::$ctrl.gridOptions" ui-grid-exporter ui-grid-resize-columns class="expression-grid"></div>\n      </div>\n    </div>\n\n  </div>\n</div>\n')}}}),System.register("components/intro/intro-data.js",[],function(_export,_context){"use strict";var steps;return{setters:[],execute:function(){steps=[{element:"#charts",intro:"DEIVA: Interactive Visual Analysis of differential gene expression test results",position:"floating"},{element:"#data-set",intro:"Simply select a differential gene expression test of interest from the dropdown..."},{element:"#data-drop",intro:"...or, import a custom input file here! See the about page for details on the input format."},{element:"#_scatter__chart",intro:"Highlight a region by drawing a rectangle."},{element:"#chart-toolbar",intro:"Use the toolbar to zoom into selected region, zoom-in, zoom-out and to reset.",position:"left"},{element:".expression-grid",intro:"This table shows the highlighted genes from the plot area. You can sort any of the columns (just click the column header)!",position:"top"},{element:".expression-grid .ui-grid-icon-container",intro:"Show addional data columns or export visible data from the table for later import into other applications.",position:"left"},{element:"#data-download",intro:"Export the complete raw data here."},{element:"#svg-download",intro:"Export the current plot as SVG."},{element:"#gene-select",intro:"Locate one or more genes of interest in the scatter plot. Different colors are automatically assigned. You can paste entire list of space separated genes!"},{element:"#gene-list-toolbar",intro:"Use these buttons to copy and clear the current list."},{element:"#fc-filter",intro:"Set a custom abs. log2 Fold Change filter."},{element:"#fdr-filter",intro:"Set a custom FDR filter."},{element:"#bm-filter",intro:"Set a custom baseMean or logCPM filter."},{element:"#_scatter__chart",intro:"Features passing these filters will be indicated in red on the plot..."},{element:"#gene-count",intro:"and the number of up- and down-regulated features that pass these filters will be displayed here."},{element:"#plot-options",intro:"Change density plot opacity, density plot type (Hexplot/Scatterplot), and plot type (MA/Volcano) here."},{element:"#plot-options",intro:"Switch between hexplot (fast) and scatter plot. The scatter plot is slower but allows inspection of each feature in the plot."},{element:"#charts",intro:"If you encounter any issues please let us know in the [DEIVA GitHub issues](https://github.com/Hypercubed/DEIVA/issues)",position:"floating"}],_export("default",steps)}}}),System.registerDynamic("components/intro/intro.md!github:Hypercubed/system-md-marked@1.0.1/md.js",[],!0,function($__require,exports,module){this||self;return module.exports='<h2 id="deiva-interactive-visual-analysis-of-differential-gene-expression-test-results">DEIVA: Interactive Visual Analysis of differential gene expression test results</h2>\n<p>DEIVA (Differential Gene Expression Interactive Visual Analysis) is a web app to interactively identify and locate genes in a hexbin or scatter plot of DESeq2 or edgeR results.</p>\n<p>Using DEIVA, domain experts can examine the results of a differential gene expression test and immediately get answers to questions such as &quot;What is the expression level of my genes of interest?&quot;, &quot;How does expression of these genes differ between the two different states?&quot;, and can easily retrieve lists of genes just by brushing (highlighting) them.</p>\n<p>DEIVA visualization conceptualized and prototyped by Anton Kratz.  Project-χ implementation of DEIVA developed by Jayson Harshbarger with inspiration from DESeq2IVA (Shiny version) and significant input from Anton Kratz.</p>\n',module.exports}),System.registerDynamic("components/intro/intro-end.md!github:Hypercubed/system-md-marked@1.0.1/md.js",[],!0,function($__require,exports,module){this||self;return module.exports='<h2 id="thank-you-">Thank you.</h2>\n<p>If you encounter any issues please let us know in the <a href="https://github.com/Hypercubed/DEIVA/issues">DEIVA GitHub issues</a>.</p>\n',module.exports}),System.register("components/intro/index.js",["angular","intro.js/introjs.css!","./intro.less!","angular-intro.js","./intro-data.js","./intro.md!","./intro-end.md!"],function(_export,_context){"use strict";var angular,steps,hello,thankYou,introOptions;return{setters:[function(_angular){angular=_angular.default},function(_introJsIntrojsCss){},function(_introLess){},function(_angularIntroJs){},function(_introDataJs){steps=_introDataJs.default},function(_introMd){hello=_introMd.default},function(_introEndMd){thankYou=_introEndMd.default}],execute:function(){steps[0].intro=hello,steps[steps.length-1].intro=thankYou,_export("introOptions",introOptions={steps:steps,showStepNumbers:!1,exitOnOverlayClick:!0,exitOnEsc:!0}),_export("introOptions",introOptions),_export("default",angular.module("intro",["angular-intro"]).name)}}}),System.register("components/scatter/chart.utils.js",["d3"],function(_export,_context){"use strict";function moveToFront(){return d3.select(this).each(function(){this.parentNode.appendChild(this)})}var d3;return _export("moveToFront",moveToFront),{setters:[function(_d){d3=_d.default}],execute:function(){}}}),System.register("components/scatter/scatter-chart.js",["npm:systemjs-plugin-babel@0.0.12/babel-helpers/slicedToArray.js","d3","d3-svg-legend","d3-plugins/hexbin/hexbin","d3-tip","d3-tip/examples/example-styles.css!","./chart.utils","./scatter-chart.less!"],function(_export,_context){"use strict";function Scatter(){function scatter(selection){selection.each(function(d){function draw(){return showDensity&&drawDensity(),update()}function update(){return showDensity&&updateDensityColor(),drawPoints()}function panLimit(){var xmin=xExtent[0],xmax=xExtent[1],ymin=yExtent[0],ymax=yExtent[1];xScale.domain()[0]<xmin?zoom.translate([zoom.translate()[0]-xScale(xmin)+xScale.range()[0],zoom.translate()[1]]):xScale.domain()[1]>xmax&&zoom.translate([zoom.translate()[0]-xScale(xmax)+xScale.range()[1],zoom.translate()[1]]),yScale.domain()[0]<ymin?zoom.translate([zoom.translate()[0],zoom.translate()[1]-yScale(ymin)+yScale.range()[0]]):yScale.domain()[1]>ymax&&zoom.translate([zoom.translate()[0],zoom.translate()[1]-yScale(ymax)+yScale.range()[1]])}function zoomTo(x,y){xScale.domain(x),yScale.domain(y),$brush.call(brush.clear()).call(brush.event),zoomed()}function zoomHome(){return zoomHistory.splice(0,zoomHistory.length),zoomTo(xExtent,yExtent)}function zoomToExtent(){if(!brush.empty()){var xd=xScale.domain(),yd=yScale.domain();zoomHistory.push([[xd[0],xd[1]],[yd[0],yd[1]]]);var _brush$extent=brush.extent(),_brush$extent2=_slicedToArray(_brush$extent,2),_brush$extent2$=_slicedToArray(_brush$extent2[0],2);xd[0]=_brush$extent2$[0],yd[0]=_brush$extent2$[1];var _brush$extent2$2=_slicedToArray(_brush$extent2[1],2);return xd[1]=_brush$extent2$2[0],yd[1]=_brush$extent2$2[1],zoomTo(xd,yd)}}function zoomIn(){var xd=xScale.domain(),yd=yScale.domain();zoomHistory.push([[xd[0],xd[1]],[yd[0],yd[1]]]);var dx=(xd[1]-xd[0])/4,dy=(yd[1]-yd[0])/4;return xd[0]+=dx,xd[1]-=dx,yd[0]+=dy,yd[1]-=dy,zoomTo(xd,yd)}function zoomOut(){var z=0===zoomHistory.length?[xExtent,yExtent]:zoomHistory.pop();return zoomTo.apply(this,z)}function zoomed(){panLimit(),container.select("g.x.axis").call(xAxis),container.select("g.y.axis").call(yAxis),midLine.attr("y1",yScale(0)).attr("y2",yScale(0)),showDensity&&(drawDensity(),updateDensityColor()),updatePointsPosition()}function drawDensity(){var hexPath=hexbin.x(xMap).y(yMap).hexagon(hsize);hd=hexbin(d);var hexagon=hexagonG.selectAll("path").data(hd);hexagon.enter().append("path"),hexagon.attr("d",hexPath).attr("transform",function(d){return"translate("+d.x+","+d.y+")"}),hexagon.exit().remove()}function updateDensityColor(){hexagonG.style("opacity",alpha),hd.forEach(function(d){var len=d.length;d.color=hexColor(d.filter(function(d){return d.$cutoffCheck}).length/len),d.opacity=showScatter?.2:hexOpacity(len)}),hexagonG.selectAll("path").style("stroke",function(d){return d.color}).style("fill",function(d){return d.color}).style("fill-opacity",function(d){return d.opacity})}function drawPoints(){legendOrdinal.scale(highlightColor),container.select(".legendOrdinal").call(legendOrdinal);var dd=showScatter?d:d.filter(function(d){return d.highlight}),points=pointsG.selectAll(".point").data(dd);points.enter().append("circle").attr("class","point").attr("x",0).attr("y",0).on("mouseover",tooltip.show).on("mouseout",tooltip.hide),points.exit().remove(),points.attr("class",function(d){return d.highlight?"point highlight":"point"}).attr("transform",function(d){return"translate("+xMap(d)+","+yMap(d)+")"}).each(function(d){var e=d3.select(this);if(d.highlight)e.style("opacity",1).attr("r",4).style("fill",highlightColor(d.highlight)),moveToFront.call(this);else{var stroke=d.$cutoffCheck?"red":"black",fill=isNaN(d.padj)?"white":stroke;e.style("opacity",alpha).attr("r",2).style("stroke",stroke).style("fill",fill)}})}function updatePointsPosition(){pointsG.selectAll(".point").attr("transform",function(d){return"translate("+xMap(d)+","+yMap(d)+")"})}var el=d3.select(this),xExtent=d3.extent(d,xValue),yExtent=d3.extent(d,yValue);xExtent[0]=Math.floor(xExtent[0]),xExtent[1]=Math.ceil(xExtent[1]);var h=yExtent[1]-yExtent[0];yExtent[0]=Math.floor(yExtent[0]-h/20),yExtent[1]=Math.ceil(yExtent[1]+h/20),xScale.domain(xExtent).range([0,width]),yScale.domain(yExtent);var zoomHistory=[],hd=null;zoom.x(xScale).y(yScale).on("zoom",zoomed),el.selectAll("svg").remove();var svg=el.append("svg").attr("class",showScatter?"scatter":"hexbin").attr("title",title).attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")");svg.append("clipPath").attr("id","rect-clip").append("rect").attr("width",width).attr("height",height),svg.append("text").attr("class","title").attr("x",width/2).attr("y",0-margin.top/2).text(title);var container=svg.append("g"),clipped=container.append("g").attr("clip-path","url(#rect-clip)");container.append("g").attr("class","x axis").attr("transform","translate(0,"+height+")").call(xAxis).append("text").attr("class","label").attr("transform","rotate(0)").attr("x",width/2).attr("y",margin.bottom).attr("dy","-.71em").text(xLabel),container.append("g").attr("class","y axis").call(yAxis).append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",-margin.left).attr("x",-height/2).attr("dy",".71em").text(yLabel);var hexagonG=clipped.append("g").attr("class","hexagons").style("opacity",alpha),$brush=clipped.append("g").attr("class","brush").call(brush),pointsG=clipped.append("g").attr("class","points"),midLine=container.append("line").attr("class","mid-line").attr("x1",0).attr("x2",width).attr("y1",yScale(0)).attr("y2",yScale(0)).attr("stroke-dasharray","10, 5");container.append("g").attr("class","legendOrdinal").attr("transform","translate("+(width+10)+",10)");var legendOrdinal=legend.color().shape("circle").shapePadding(10).shapeRadius(5).scale(highlightColor);return hexbin.size([width,height]),tooltip.attr("class","d3-tip d3-tip-scatter n"+(showScatter?"":" animate")),svg.call(tooltip),scatter.updatePoints=update,scatter.zoomExtent=zoomToExtent,scatter.zoomIn=zoomIn,scatter.zoomOut=zoomOut,scatter.zoomHome=zoomHome,draw()})}var opts=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],margin=opts.margin||{top:20,right:20,bottom:30,left:40},width=(opts.width||1024)-margin.left-margin.right,height=(opts.height||500)-margin.top-margin.bottom,title=opts.title||"DEIVA",alpha=.1,showScatter=!1,showDensity=!0,labelFormat=d3.format("1.3f"),expFormat=d3.format(".0e"),xValue=opts.xValue||function(d){return Number(d.baseMean)||.01},xLabel=opts.xLabel||"baseMean",xScale=d3.scale.linear().range([0,width]),xMap=function(d){return xScale(xValue(d))},xAxis=d3.svg.axis().scale(xScale).orient("bottom"),yValue=opts.yValue||function(d){return Number(d.log2FoldChange)||0},yLabel=opts.yLabel||"log2FoldChange",yScale=d3.scale.linear().range([height,0]),yMap=function(d){return yScale(yValue(d))},yAxis=d3.svg.axis().scale(yScale).orient("left"),highlightColor=opts.highlightColor||d3.scale.category10(),hsize=4,hexbin=d3.hexbin().radius(hsize),hexColor=d3.scale.linear().domain([0,1]).range(["black","red"]).interpolate(d3.interpolateLab),hexOpacity=d3.scale.linear().domain([0,10]).range([0,1]).clamp(!0),brush=scatter.brush=d3.svg.brush().x(xScale).y(yScale).clamp(!1),tooltipHtml=function(d){var a="<p>\n        "+d.symbol+"\n        <br />\n        "+d.feature+"\n      </p>",b="undefined"==typeof d.logCPM?"baseMean: "+labelFormat(d.baseMean)+"<br />":"logCPM: "+labelFormat(d.logCPM)+"<br />",c="log2FoldChange: "+labelFormat(d.log2FoldChange)+"<br />\n      P-Value:  "+expFormat(d.pvalue)+"<br />\n      FDR: "+expFormat(d.padj);return a+b+c},tooltip=tip().attr("class","d3-tip d3-tip-scatter"+(showScatter?"":" animate")).html(tooltipHtml).offset([-10,0]),zoom=d3.behavior.zoom().x(xScale).y(yScale).scaleExtent([1,10]);return scatter.title=function(_){return arguments.length<1?title:(title=_,scatter)},scatter.x=function(_){return arguments.length<1?xValue:(xValue=_,scatter)},scatter.y=function(_){return arguments.length<1?yValue:(yValue=_,scatter)},scatter.xLabel=function(_){return arguments.length<1?xLabel:(xLabel=_,scatter)},scatter.yLabel=function(_){return arguments.length<1?yLabel:(yLabel=_,scatter)},scatter.highlightColor=function(_){return arguments.length<1?highlightColor:(highlightColor=_,scatter)},scatter.showScatter=function(_){return arguments.length<1?showScatter:(showScatter=_,scatter)},scatter.showDensity=function(_){return arguments.length<1?showDensity:(showDensity=_,scatter)},scatter.width=function(_){return arguments.length<1?width:(width=(_||1024)-margin.left-margin.right,scatter)},scatter.height=function(_){return arguments.length<1?height:(height=(_||500)-margin.left-margin.right,scatter)},scatter.alpha=function(_){return arguments.length<1?alpha:(alpha=_,scatter)},scatter}var _slicedToArray,d3,legend,tip,moveToFront;return _export("default",Scatter),{setters:[function(_npmSystemjsPluginBabel0012BabelHelpersSlicedToArrayJs){_slicedToArray=_npmSystemjsPluginBabel0012BabelHelpersSlicedToArrayJs.default},function(_d){d3=_d.default},function(_d3SvgLegend){legend=_d3SvgLegend.legend},function(_d3PluginsHexbinHexbin){},function(_d3Tip){tip=_d3Tip.default},function(_d3TipExamplesExampleStylesCss){},function(_chartUtils){moveToFront=_chartUtils.moveToFront},function(_scatterChartLess){}],execute:function(){}}}),System.register("components/scatter/scatter.controller.js",["npm:systemjs-plugin-babel@0.0.12/babel-helpers/extends.js","d3","crossfilter","lodash","clipboard","mobx","../intro/index","./scatter-chart"],function(_export,_context){"use strict";function persistantColorStore(defaultColorScale){function scale(id){var color=map[id]||defaultColorScale(id);return map[id]=color,color}defaultColorScale=defaultColorScale||d3.scale.category10();var map=Object.create(null);return Object.freeze({scale:scale,map:map})}function controller($scope,dataService,$log,$timeout,growl){function loadDataset(set){return $container.classed("dirty",!0),transaction(function(){return dataService.loadResource(dataPackage,{name:set.name,title:set.name,path:set.filename,data:[],content:""}).then(function(r){return r.$error?($log.error(r),$container.classed("dirty",!1)):(dataPackage.resources.length>1&&dataPackage.resources.pop().stop(),dataPackage.resources.push(r),main.resources=dataPackage.resources.slice(),main.gene=set.gene||set.symbols||"",main.geneList=[],change(r.data))})})}function updateList(){$log.debug("update list");var xFilter=isEdgeR?main.dataState.byLogCPM:main.dataState.byBaseMean,yFilter=main.dataState.byLog2FoldChange,pFilter=main.dataState.byPvalue;if(chart.brush.empty())xFilter.filterAll(),pFilter.filterAll(),yFilter.filterAll();else{var extent=chart.brush.extent();"MA"===main.plotState.plotType?(isEdgeR||(extent[0][0]=Math.pow(10,extent[0][0]),extent[1][0]=Math.pow(10,extent[1][0])),pFilter.filterAll(),xFilter.filterRange([extent[0][0],extent[1][0]])):(extent[0][0]=Math.pow(10,-extent[0][0]),extent[1][0]=Math.pow(10,-extent[1][0]),xFilter.filterAll(),pFilter.filterRange([extent[1][0],extent[0][0]])),yFilter.filterRange([extent[0][1],extent[1][1]])}main.gridOptions.data=yFilter.top(1/0)}function setupChart(){if(main.dataState.data){var pcut=Math.pow(10,Number(main.plotState.logpcut)),fccut=Number(main.plotState.fccut),cutoffCheck=void 0;isEdgeR?!function(){var bmcut=Number(main.plotState.bmcut);cutoffCheck=function(d){return d.padj<=pcut&&d.logCPM>bmcut&&(d.log2FoldChange>fccut||d.log2FoldChange<-fccut)}}():!function(){var bmcut=Math.pow(10,Number(main.plotState.bmcut));cutoffCheck=function(d){return d.padj<=pcut&&d.baseMean>bmcut&&(d.log2FoldChange>fccut||d.log2FoldChange<-fccut)}}();var symbolDomain=main.geneList.map(function(x){return x.symbol});highlightColor.domain(symbolDomain).range(symbolDomain.map(colorScale.scale));var d=main.dataState.data.filter(function(d){return d.$cutoffCheck=cutoffCheck(d),d.highlight=symbolDomain.find(function(symbol){return d.symbols.includes(symbol)}),d.$cutoffCheck}),resource=dataPackage.resources[1],plotType=main.plotState.plotType,width=parseInt($container.style("width"),10);chart.x(x[plotType]).y(function(d){return d.log2FoldChange||0}).xLabel(xLabel[plotType]).yLabel("log2FoldChange").title(resource.title||resource.name).showScatter("scatter"===main.plotState.plot).showDensity("hex"===main.plotState.plot).highlightColor(highlightColor).alpha(main.plotState.alpha).width(width),main.upDown[0]=d.filter(function(d){return d.log2FoldChange>0}).length,main.upDown[1]=d.length-main.upDown[0]}}function change(data){return $log.debug("change"),$container.classed("dirty",!0),data=data||main.resources[1].data,isEdgeR="undefined"!=typeof data.logCPM,$timeout(function(){data=processData(data),setupUI(data),setupChart(),δdrawChart()},10)}function drawChart(){$log.debug("draw"),$container.classed("dirty",!0),setupChart(),δdrawChart()}function updateChartData(){$log.debug("update"),$container.classed("dirty",!0),setupChart(),δchartAction("updatePoints")}function setupUI(data){$log.debug("sutupUI");var resource=dataPackage.resources[1];isEdgeR?(x.MA=function(d){return d.logCPM},xLabel.MA="logCPM"):(x.MA=function(d){return Math.log10(d.baseMean)},xLabel.MA="log10 baseMean");var xExtent=d3.extent(data,x.MA);xExtent[0]=Math.floor(xExtent[0]),xExtent[1]=Math.ceil(xExtent[1]),sliders.bmcut.floor=xExtent[0],sliders.bmcut.ciel=xExtent[1],Object.assign(main.plotState,{fccut:0,bmcut:xExtent[0],logpcut:-1,alpha:.8,plot:"hex",plotType:"MA"});var ignoredKeys=["pvalue","padj","baseMean","logCPM","log2FoldChange","symbols","symbol","feature"];if(data.length<1)return void growl.error("Failed to find any features in "+resource.name);var cf=crossfilter(data);main.dataState={},main.dataState.byPvalue=cf.dimension(function(d){return d.pvalue}).filterAll(),isEdgeR?main.dataState.byLogCPM=cf.dimension(function(d){return d.logCPM}).filterAll():main.dataState.byBaseMean=cf.dimension(function(d){return d.baseMean}).filterAll(),main.dataState.byLog2FoldChange=cf.dimension(function(d){return d.log2FoldChange}).filterAll(),main.gridOptions.data=main.dataState.data=main.dataState.byLog2FoldChange.top(1/0),main.gridOptions.columnDefs=columnDefs.slice(),isEdgeR&&(main.gridOptions.columnDefs[2]={name:"logCPM",displayName:"log2 CPM",type:"number",cellFilter:"number",enableFiltering:!1}),Object.keys(data[0]).forEach(function(key){ignoredKeys.includes(key)||main.gridOptions.columnDefs.push({name:key,displayName:key,visible:!1})}),$log.debug("getting unique symbols");var uniqGeneMap=Object.create(null);
return flatMap(data,function(d){return d.symbols}).sort().forEach(function(symbol){var item=uniqGeneMap[symbol]||(uniqGeneMap[symbol]={symbol:symbol,count:0});item.count++}),main.uniqGeneMap=uniqGeneMap,main.uniqGeneList=values(uniqGeneMap),$log.debug("done getting unique symbols",main.uniqGeneList.length),main.geneList=[],addSymbols(main.gene)}function processData(data){return $log.debug("processData"),data.filter(function(d){return d.pvalue=Number(d.pvalue)||Number(d.PValue),delete d.PValue,d.padj=Number(d.padj)||Number(d.FDR)||NaN,delete d.FDR,"undefined"==typeof d.logCPM?d.baseMean=Number(d.baseMean)||NaN:(d.baseMean=Math.pow(2,Number(d.logCPM))||NaN,d.logCPM=Number(d.logCPM)),d.log2FoldChange=Number(d.log2FoldChange)||Number(d.logFC)||0,delete d.logFC,d.feature=d.feature||d.ID,delete d.ID,d.symbol=d.symbol||d.Gene_Symbol||d.feature,delete d.Gene_Symbol,d.symbols=d.symbol.split(";"),!isNaN(d.baseMean)})}function addSymbols(list){var toggle=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if("string"==typeof list&&0!==list.length){var arr=main.geneList,missing=[];if(list.split(/[\s;]/).forEach(function(symbol){var item=main.uniqGeneMap[symbol];if(item){var index=arr.indexOf(item);index>-1?toggle&&(arr.splice(index,1),item.selected=!1):(arr.push(item),item.selected=!0,colorScale.scale(item.symbol))}else missing.push(symbol)}),missing.length>0){var msg=missing.join(", ");$log.error("Symbols not found",msg),growl.error(msg,{title:"Symbols not found"})}}}function selectFile(file){dropped(file)}function dropped(file){$container.classed("dirty",!0);var mediatype=file.type||dataService.mime.lookup(file.name),newResource=dataPackage.resources[1];return transaction(function(){Object.assign(newResource,{title:file.name,path:file.name||"file",name:file.name||"file",mediatype:"text/plain"===mediatype?"text/tab-separated-values":mediatype,schema:dataPackage.schemas.deseq2oredgeR,content:file.content||""})}),newResource.$error?$container.classed("dirty",!1):(main.selectedData=null,main.gene="",main.geneList=[],void change(newResource.data))}var main=this,isEdgeR=!1,$container=d3.select("#_scatter__chart"),colorScale=persistantColorStore(d3.scale.category10()),highlightColor=d3.scale.ordinal(),x={MA:function(d){return Math.log10(d.baseMean)},Volcano:function(d){return-Math.log10(d.pvalue||1)}},xLabel={MA:"log10 baseMean",Volcano:"-log10 P-Value"},chart=new ScatterChart({width:parseInt($container.style("width"),10),height:530,margin:{top:30,right:100,bottom:40,left:40},highlightColor:colorScale.scale}),clipboard=new Clipboard("#clipboard-btn",{text:function(){return main.geneList.map(function(x){return x.symbol}).join(" ")}});clipboard.on("error",function(){prompt("This browser does not suppport copying directly to clipboard.  Copy this text instead.",main.geneList.map(function(x){return x.symbol}).join(" "))});var sliders={alpha:{showTicksValues:!1,showTicks:!1,enforceStep:!1,floor:0,ceil:1,step:.01,precision:2,onEnd:updateChartData,translate:function(value,sliderId,label){switch(label){case"model":return"Opacity: "+value;default:return value}}},fccut:_extends({},sliderOpts,{floor:0,ceil:5,step:1,onEnd:updateChartData}),logpcut:_extends({},sliderOpts,{floor:-5,ceil:0,step:1,onEnd:updateChartData}),bmcut:_extends({},sliderOpts,{floor:-5,ceil:5,step:1,onEnd:updateChartData})},δdrawChart=debounce(function(){$container.selectAll("svg").remove(),$container.select(".chart").datum(main.dataState.data).call(chart),$container.classed("dirty",!1)},30),δupdateList=debounce(function(){$scope.$applyAsync(function(){updateList()})},30),δchartAction=debounce(function(action){$container.classed("dirty",!0),$scope.$applyAsync(function(){chart[action](),$container.classed("dirty",!1)})},30),dataPackage=main.dataPackage,resources=dataPackage.resources.slice(),experimentList=resources[0].data;return Object.assign(main,{resources:resources,experimentList:experimentList,editorOptions:{data:dataPackage,enableOpen:!1},gene:experimentList[0].gene,selectedData:experimentList[0],geneList:[],colorMap:colorScale.map,uiState:{dataset:!0,locate:!0,filters:!0,plot:!0,fccut:!0,logpcut:!0,bmcut:!0},plotState:{fccut:0,bmcut:-5,logpcut:-1,alpha:.8,plot:"hex",plotType:"MA"},xLabel:xLabel,upDown:[0,0],dataState:{},introOptions:introOptions,dropped:dropped,selectFile:selectFile,gridOptions:gridOptions,draw:drawChart,update:updateChartData,change:change,loadDataset:loadDataset,pasteSymbols:function(list){addSymbols(list),updateChartData()},toggleSymbols:function(sym){addSymbols(sym,!0),updateChartData()},chart:chart,$container:$container,updateList:δupdateList,sliders:sliders,chartAction:δchartAction,$onInit:function(){return Object.assign(main.uiState,{dataset:!0,locate:!0,filters:!0,plot:!0,fccut:!0,logpcut:!0,bmcut:!0}),chart.brush.on("brushend.select",δupdateList),loadDataset(experimentList[0])}})}var _extends,d3,crossfilter,debounce,flatMap,values,Clipboard,transaction,introOptions,ScatterChart,cellTemplate,columnDefs,gridOptions,sliderOpts;return{setters:[function(_npmSystemjsPluginBabel0012BabelHelpersExtendsJs){_extends=_npmSystemjsPluginBabel0012BabelHelpersExtendsJs.default},function(_d){d3=_d.default},function(_crossfilter){crossfilter=_crossfilter.default},function(_lodash){debounce=_lodash.debounce,flatMap=_lodash.flatMap,values=_lodash.values},function(_clipboard){Clipboard=_clipboard.default},function(_mobx){transaction=_mobx.transaction},function(_introIndex){introOptions=_introIndex.introOptions},function(_scatterChart){ScatterChart=_scatterChart.default}],execute:function(){cellTemplate='\n<div class="ui-grid-cell-contents">\n  <span ng-switch="COL_FIELD">\n    <span ng-switch-when="NA">\n      {{COL_FIELD}}\n    </span>\n    <span ng-switch-default>\n      <a href ng-click="grid.appScope.$ctrl.toggleSymbols(COL_FIELD)">\n        {{COL_FIELD}}\n      </a>\n    </span>\n  </span>\n</div>',columnDefs=[{name:"feature"},{name:"symbol",cellTemplate:cellTemplate},{name:"baseMean",displayName:"Base Mean",type:"number",cellFilter:"number",enableFiltering:!1},{name:"log2FoldChange",displayName:"Log2 Fold Change",type:"number",cellFilter:"number",enableFiltering:!1},{name:"pvalue",displayName:"P-Value",type:"number",cellFilter:"number",enableFiltering:!1},{name:"padj",displayName:"FDR",type:"number",cellFilter:"number",sort:{direction:"asc"},enableFiltering:!1}],gridOptions={columnDefs:columnDefs,enableFiltering:!0,enableRowSelection:!1,enableSelectAll:!1,selectionRowHeaderWidth:35,enableFullRowSelection:!0,enableRowHeaderSelection:!1,enableColumnResizing:!0,rowHeight:25,showGridFooter:!1,multiSelect:!1,enableColumnMenus:!1,noUnselect:!0,enableGridMenu:!0,exporterMenuCsv:!0,exporterMenuPdf:!1,exporterCsvFilename:"selection.csv",exporterMenuAllData:!1,flatEntityAccess:!0},sliderOpts={showTicksValues:!0,showTicks:!0,enforceStep:!1},controller.$inject=["$scope","dataService","$log","$timeout","growl"],_export("default",controller)}}}),System.register("components/scatter/scatter.component.js",["./scatter.less!","common/partials/header.html!text","./scatter.html!text","./scatter.controller"],function(_export,_context){"use strict";var headerHTML,template,controller;return{setters:[function(_scatterLess){},function(_commonPartialsHeaderHtmlText){headerHTML=_commonPartialsHeaderHtmlText.default},function(_scatterHtmlText){template=_scatterHtmlText.default},function(_scatterController){controller=_scatterController.default}],execute:function(){_export("default",{controller:controller,template:headerHTML+template,bindings:{dataPackage:"<package"}})}}}),System.register("common/partials/header.html!github:systemjs/plugin-text@0.0.9/text.js",[],function(_export,_context){"use strict";var __useDefault;return{setters:[],execute:function(){_export("__useDefault",__useDefault=!0),_export("__useDefault",__useDefault),_export("default",'<div class="header">\n\t<div class="navbar navbar-default" role="navigation">\n\t\t<div class="container-fluid">\n\t\t\t<div class="navbar-header">\n\n\t\t\t\t<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#js-navbar-collapse">\n\t\t\t\t\t<span class="sr-only">Toggle navigation</span>\n\t\t\t\t\t<span class="icon-bar"></span>\n\t\t\t\t\t<span class="icon-bar"></span>\n\t\t\t\t\t<span class="icon-bar"></span>\n\t\t\t\t</button>\n\n\t\t\t\t<a class="navbar-brand" href="#/">DEIVA</a>\n\t\t\t</div>\n\n\t\t\t<div class="collapse navbar-collapse pull-right" id="js-navbar-collapse">\n\t\t\t\t<ul class="nav navbar-nav">\n\n\n          <li id="data-download" class="dropdown" uib-dropdown ng-if="::($ctrl && $ctrl.dataPackage)">\n            <a href type="button" class="dropdown-toggle" uib-dropdown-toggle aria-expanded="false">\n              <div>\n                <i class="fa fa-arrow-circle-o-down" aria-hidden="true"></i>\n                Download Data <span class="caret"></span>\n              </div>\n            </a>\n            <ul class="dropdown-menu" role="menu">\n              <li class="dropdown-header">Data Resources</li>\n              <li ng-repeat="file in $ctrl.resources">\n                <a class="btn btn-link" file-download="file">{{file.name}}</a>\n              </li>\n            </ul>\n          </li>\n\n          <li id="svg-download" class="dropdown" uib-dropdown svg-download-dropdown="svgList in #charts" ng-if="::($ctrl && $ctrl.dataPackage)">\n            <a href type="button" class="dropdown-toggle" uib-dropdown-toggle aria-expanded="false">\n              <div>\n                <i class="fa fa-picture-o" aria-hidden="true"></i>\n                Download SVG <span class="caret"></span>\n              </div>\n            </a>\n            <ul class="dropdown-menu" role="menu">\n              <li ng-repeat="svg in svgList">\n                <a class="btn btn-link" svg-download="#{{svg.id}}" title="{{svg.title}}">{{svg.title}} as SVG</a>\n              </li>\n            </ul>\n          </li>\n\n          <li id="intro" ng-if="::($ctrl && $ctrl.dataPackage)">\n            <a href ng-click="CallMe()">Show me</a>\n          </li>\n\n\t\t\t\t\t<li active-path="/about">\n            <a ng-href="#/about">About</a>\n          </li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n')}}}),System.registerDynamic("components/about/readme.md!github:Hypercubed/system-md-marked@1.0.1/md.js",[],!0,function($__require,exports,module){this||self;return module.exports='<h1 id="deiva-interactive-visual-analysis-of-differential-gene-expression-test-results">DEIVA: Interactive Visual Analysis of differential gene expression test results</h1>\n<h2 id="interactive-exploration-of-gene-expression-tests-made-easy">Interactive exploration of gene expression tests made easy</h2>\n<p>DEIVA (Differential Gene Expression Interactive Visual Analysis) is a web app to interactively identify and locate genes in a hexbin or scatter plot of DESeq2 or edgeR results.</p>\n<p>The aim was to create a web app that meets user expectations and can be used without any knowledge of R, spreadsheets, or programming.</p>\n<p>Using DEIVA, domain experts can examine the results of a differential gene expression test and immediately get answers to questions such as &quot;What is the expression level of my genes of interest?&quot;, &quot;How does expression of these genes differ between the two different states?&quot;, and can easily retrieve lists of genes just by brushing (highlighting) them.</p>\n<p>While this could also be achieved using any spreadsheet program like Excel, LO Calc or Google Sheets, that process would be slow, cumbersome, and not intuitive.</p>\n<p>DEIVA provides an interface where domain experts simply go to a URL and can immediately search for genes, retrieve genes, and filter results lists.</p>\n<h2 id="features">Features</h2>\n<ul>\n<li><strong>Select</strong> an experiment from a drop-down list of datasets results.</li>\n<li><strong>Identify</strong> genes by brushing.</li>\n<li><strong>Locate</strong> genes by searching for their name. <strong>Multiple genes can be located at the same time</strong> (separated by a space), and are <strong>automatically highlighted in different colors</strong></li>\n<li><strong>Search</strong> for genes in the data table.</li>\n<li><strong>Zoom</strong> using the toolbar to zoom into selected rectangle and to reset.</li>\n<li><strong>Filter</strong> two different cut-off sliders which are linked by logical &quot;and&quot;. Number of genes passing the filter, up and down, is shown.</li>\n<li><strong>Mobile device support</strong>. The user interface adapts to desktop as well as mobile environment devices.</li>\n<li><strong>User data</strong>.  Drag and drop formatted DGE files onto the plot area to view in DEIVA. (See <a href="#preparing-input-data-files">Preparing input data files</a>)</li>\n</ul>\n<h2 id="using-the-deiva-web-interface">Using the DEIVA web interface</h2>\n<p>The interface is self-explanatory and should be usable by anyone accustomed to a contemporary web app.  If you require further instructions use the &quot;Show me&quot; in the upper right of the user interface.</p>\n<h2 id="preparing-input-data-files">Preparing input data files</h2>\n<p>The code provided here works out of the box with the example given. But DEIVA can easily be expanded and modified to your own project. In particular the input data file can be augmented by more columns encoding gene features of interest, and these features can be rendered in different styles in the plot.</p>\n<p>You need at least one input data file, which is a slightly augmented output from either DESeq2 or edgeR.</p>\n<p>Please keep in mind that neither DESeq2 nor edgeR have an &quot;output format&quot; as such, the exact format in which you write the resulting tables to disc depends on which function in R you use.</p>\n<h3 id="deseq2-flavor">DESeq2 flavor</h3>\n<p>The input file needs to have the following columns:</p>\n<ul>\n<li>feature</li>\n<li>symbol</li>\n<li>baseMean</li>\n<li>log2FoldChange</li>\n<li>pvalue</li>\n<li>padj</li>\n</ul>\n<p>The header <em>does</em> contain an entry for the first column! Typically, when wrinting a data frame from R, containing the result of a DESeq2 analysis, a user might omit the first entry and keep the first column unnamed - however it is required in this application.</p>\n<p>DESeq2 does not have a standard output file format. Write the result of a differential expression test to a file with TAB or COMMA as the separator and no hyphens to delineate fields.  The file should be name appropriately (.tsv for tab separated, .csv for comma separated).</p>\n<p>The DESeq2 output is augmented by one column: <code>symbol</code>. This contains a symbol (or symbols separated by semicolons) associated with the feature (cluster, transcription initiation site) of interest. These symbols are searched for when using the &quot;Locate symbol&quot; feature. The feature column can not be used for this, because there is no one-to-one relationship between features and genes.</p>\n<p>Example for a DEIVA input file:</p>\n<table>\n<thead>\n<tr>\n<th>feature</th>\n<th>symbol</th>\n<th>baseMean</th>\n<th>log2FoldChange</th>\n<th>lfcSE</th>\n<th>stat</th>\n<th>pvalue</th>\n<th>padj</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>chr2_246405441_246405521_+</td>\n<td>Grid</td>\n<td>1.64173845899039</td>\n<td>0.899050240043084</td>\n<td>4.76263324936837</td>\n<td>0.188771671671825</td>\n<td>0.850271775363256</td>\n<td>0.925548049366256</td>\n</tr>\n<tr>\n<td>chr12_54086426_54086466_+</td>\n<td>Pcp2</td>\n<td>5.30160933550825</td>\n<td>1.61745325417192</td>\n<td>4.82390235826869</td>\n<td>0.335299749879769</td>\n<td>0.737398982387807</td>\n<td>0.864181693747462</td>\n</tr>\n<tr>\n<td>chr7_36876604_36876766_+</td>\n<td>n/a</td>\n<td>1.18273903072599</td>\n<td>-6.06413567391466</td>\n<td>3.87533117153996</td>\n<td>1.564804504567</td>\n<td>0.117628755226941</td>\n<td>0.585133009869474</td>\n</tr>\n</tbody>\n</table>\n<p><strong>The symbol column is optional.</strong></p>\n<p><strong>Columns may appear in any order.</strong></p>\n<p><strong>Multiple symbols in the symbol must b separated by semicolons</strong></p>\n<h3 id="edger-flavor">edgeR flavor</h3>\n<p>When starting from edgeR output, the input file needs to have the following columns:</p>\n<ul>\n<li>feature</li>\n<li>logFC</li>\n<li>logCPM</li>\n<li>LR</li>\n<li>PValue</li>\n<li>FDR</li>\n<li>symbol</li>\n</ul>\n<p>An alternative input format is also possible, this is especially useful when starting from edgeR files:</p>\n<table>\n<thead>\n<tr>\n<th>feature</th>\n<th>logFC</th>\n<th>logCPM</th>\n<th>LR</th>\n<th>PValue</th>\n<th>FDR</th>\n<th>symbol</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>chr10_100486611_100486680_+</td>\n<td>-0.792817368178757</td>\n<td>6.15713415308089</td>\n<td>5.89498642469805</td>\n<td>0.0151840465950009</td>\n<td>0.0413077938423281</td>\n<td>Kcnj16</td>\n</tr>\n<tr>\n<td>chr10_102389850_102389932_+</td>\n<td>0.971318236831185</td>\n<td>3.51479142943153</td>\n<td>2.31041232774695</td>\n<td>0.128509956456949</td>\n<td>0.233565642765819</td>\n<td>NA</td>\n</tr>\n<tr>\n<td>chr10_102393454_102393460_+</td>\n<td>1.21869694330981</td>\n<td>3.74540666988435</td>\n<td>5.39366227820117</td>\n<td>0.020210011581406</td>\n<td>0.0523206275040398</td>\n<td>NA</td>\n</tr>\n</tbody>\n</table>\n<h3 id="detailed-example-on-generating-deseq2-and-edger-based-input-files">Detailed example on generating DESeq2 and edgeR-based input files</h3>\n<p>See this git repository, describing how the example input files for DEIVA have been generated:</p>\n<p><a href="https://github.com/antonkratz/genome-research-edgeR-DESeq2.git">antonkratz/genome-research-edgeR-DESeq2</a></p>\n<h1 id="deploying-deiva-with-your-own-data">Deploying DEIVA with your own data</h1>\n<h2 id="pre-built">Pre-built</h2>\n<p>DEIVA may be used with custom data without modification to the source code.  Download the <a href="https://github.com/Hypercubed/DEIVA/tree/gh-pages">gh-pages branch</a> of this project and replace the files in the <code>app/data/</code> with your data.  (See <a href="##preparing-input-data-files">Preparing input data files</a>).  You will also need to modify the <code>datapackage.json</code> and <code>index.tsv</code> files (see example <a href="https://github.com/Hypercubed/DEIVA/tree/gh-pages/data">here</a>).</p>\n<h2 id="building-from-source">Building from source</h2>\n<p>DEIVA was developed using the <a href="https://github.com/Hypercubed/Project-chi">Project χ toolkit</a>.  If you are not familiar with Project-χ please see <a href="https://github.com/Hypercubed/Project-chi#readme">here</a>.  To utilize Project χ You should be familiar with <a href="http://jspm.io/">JSPM</a>, <a href="https://github.com/systemjs/systemjs">SystemJS</a>, and <a href="http://gulpjs.com/">Gulp</a>.</p>\n<pre><code class="lang-sh">git clone https://github.com/Hypercubed/Project-Chi.git\ncd Project-Chi\ngit checkout tags/v1.0.0-beta  # ensure you are using the same version of Project χ\nnpm install # jspm install is run post-install by npm\ngit clone https://github.com/Hypercubed/DEIVA.git dataset/DEIVA\n</code></pre>\n<p>Now add your data to the <code>./dataset/DEIVA/app/data</code> directory (see example <a href="https://github.com/Hypercubed/DEIVA/tree/gh-pages/data">here</a>).  Alternatively you may download data from <a href="https://github.com/antonkratz/genome-research-edgeR-DESeq2">antonkratz/genome-research-edgeR-DESeq2</a>:</p>\n<pre><code class="lang-sh">svn checkout https://github.com/antonkratz/genome-research-edgeR-DESeq2/trunk/annotated\nmv annotated/* dataset/DEIVA/app/data/\nrm -rf annotated/\n</code></pre>\n<p>Start the development server:</p>\n<pre><code class="lang-sh">gulp dev --dataset=./dataset/DEIVA/\n# navigate to http://localhost:9000\n</code></pre>\n<h1 id="about-project-">About Project χ</h1>\n<p>This website was built using the <a href="https://github.com/Hypercubed/Project-chi">Project χ platform</a>. Project χ (pronounced project kai or /<abbr title="/ˈ/ primary stress follows">ˈ</abbr><abbr title="\'k\' in \'kind\'">k</abbr><abbr title="/iː/ long \'e\' in \'bead\'">iː</abbr>/) is an modular open source visualization gallery toolkit built by Jayson Harshbarger at the <a href="http://www.yokohama.riken.jp/english/">RIKEN Institute in Yokohama Japan</a>.  It offers a template and toolset for building self-hosted data-centric visualization websites. Geared towards sharing of supplemental materials associated with scientific publications; Project χ allows visitors to interact with visualizations, download associated data and images, and even try the visualization with their own uploaded or publicly available datasets.  For developers the framework comes packaged with tools necessary for quickly integrating interactive visualizations using <a href="http://d3js.org/">d3.js</a>, <a href="https://angularjs.org/">AngularJS</a>, and <a href="http://biojs.io/">BioJS</a>. More information can be found <a href="https://github.com/Hypercubed/Project-chi#readme">here</a>.</p>\n<h1 id="contact">Contact</h1>\n<p>For more information please contact <a href="mailto:jayson.harshbarger@riken.jp">J. Harshbarger</a></p>\n<h2 id="how-to-cite">How to cite</h2>\n<p>TBD</p>\n<h2 id="acknowledgments">Acknowledgments</h2>\n<p>DEIVA visualization conceptualized and prototyped by Anton Kratz.</p>\n<p>Project-χ implementation of DEIVA developed by Jayson  Harshbarger with inspiration from DESeq2IVA (Shiny version) and significant input from Anton Kratz.</p>\n<p>This work was supported by a research grant from the Japanese Ministry of Education, Culture, Sports, Science and Technology (MEXT) to the RIKEN Center for Life Science Technologies.</p>\n<h2 id="source-code-license">Source Code License</h2>\n<p><a href="http://en.wikipedia.org/wiki/MIT_License">MIT License</a></p>\n<p>Copyright (c) 2016 RIKEN, Japan.</p>\n<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>\n<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>\n<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>\n',module.exports}),System.registerDynamic("components/about/about.css!github:systemjs/plugin-css@0.1.32/css.js",[],!1,function($__require,$__exports,$__module){var _retrieveGlobal=System.get("@@global-helpers").prepareGlobal($__module.id,null,null);return function($__global){}(this),_retrieveGlobal()}),System.register("components/about/about.component.js",["common/partials/header.html!text","./readme.md!","./about.css!"],function(_export,_context){"use strict";var headerHTML,template;return{setters:[function(_commonPartialsHeaderHtmlText){headerHTML=_commonPartialsHeaderHtmlText.default},function(_readmeMd){template=_readmeMd.default},function(_aboutCss){}],execute:function(){_export("default",{template:""+headerHTML+template})}}}),System.register("components/routes.js",["angular","ui-select/dist/select","ui-select/dist/select.css!","common/services/grid/grid","common/directives/slider/index","./intro/index","./scatter/scatter.component","./about/about.component","spectrum-colorpicker","spectrum-colorpicker/spectrum.css!","angular-spectrum-colorpicker"],function(_export,_context){"use strict";function configRoute($routeProvider){$routeProvider.when("/about",{template:"<about></about>"}).when("/error",{templateUrl:"components/error/error.html"}).when("/404",{templateUrl:"components/error/error.html"}).when("/",{template:'<scatter data-package="$resolve.dataPackage"></scatter>',datapackageUrl:"data/datapackage.json"}).otherwise({redirectTo:"/"})}var angular,grid,slider,intro,scatterComponent,aboutComponent;return{setters:[function(_angular){angular=_angular.default},function(_uiSelectDistSelect){},function(_uiSelectDistSelectCss){},function(_commonServicesGridGrid){grid=_commonServicesGridGrid.default},function(_commonDirectivesSliderIndex){slider=_commonDirectivesSliderIndex.default},function(_introIndex){intro=_introIndex.default},function(_scatterScatterComponent){scatterComponent=_scatterScatterComponent.default},function(_aboutAboutComponent){aboutComponent=_aboutAboutComponent.default},function(_spectrumColorpicker){},function(_spectrumColorpickerSpectrumCss){},function(_angularSpectrumColorpicker){}],execute:function(){configRoute.$inject=["$routeProvider"],_export("default",angular.module("routes",[grid,intro,"ui.select","angularSpectrumColorpicker",slider]).component("scatter",scatterComponent).component("about",aboutComponent).config(configRoute).name)}}}),System.register("common/directives/svg-download-dropdown.js",["angular-downloadsvg-directive"],function(_export,_context){"use strict";function link(scope,element,attr){function getSVGs(){var el=attr.svgDownloadDropdown?angular.element(document.querySelector(sAttr[1])):element.parent,svgs=el.find("svg"),ids=[];angular.forEach(svgs,function(svg,d){var elm=angular.element(svg),id=elm.attr("id")||"svg-"+d,title=elm.attr("title")||id,o={id:id,title:title};elm.attr(o),ids.push(o)}),scope[sAttr[0]]=ids}var sAttr=attr.svgDownloadDropdown.split(/\sin\s/);getSVGs(),element.on("click",function(){scope.$apply(function(){getSVGs()})})}var module;return{setters:[function(_angularDownloadsvgDirective){}],execute:function(){module=angular.module("svgDownloadDropdown",["hc.downloader"]).directive("svgDownloadDropdown",function(){return{link:link}}).run(["$rootScope","cfpLoadingBar","$log",function($rootScope,cfpLoadingBar,$log){$rootScope.$on("$svgSaver:start",function(){$log.debug("$svgSaver:start"),cfpLoadingBar.start()}),$rootScope.$on("$svgSaver:end",function(){cfpLoadingBar.complete()}),$rootScope.$on("$svgSaver:error",function(){cfpLoadingBar.complete()})}]),_export("default",module.name)}}}),System.register("common/directives/file-drop.js",["angular","common/services/datapackage/datapackage"],function(_export,_context){"use strict";function fileReadService($log,growl){var service={processFile:function(file,scope){var reader=new FileReader;reader.onload=function(evt){file.content=evt.target.result;var type=file.type||dp.mime.lookup(file.name);if(service.checkSize(file.size,scope)&&service.checkType(type,scope))return scope.$apply(function(){scope.onReadFile({file:file})})},reader.readAsText(file)},checkSize:function(size,opts){var _ref=opts.maxFileSize;return void 0===_ref||""===_ref||size/1024/1024<opts.maxFileSize||(growl.error("File must be smaller than "+opts.maxFileSize+" MB"),!1)},checkType:function(type,opts){return void 0===opts.validMimeTypes||""===opts.validMimeTypes||opts.validMimeTypes.indexOf(type)>-1||(growl.error("Invalid file type "+type+".  File must be one of following types "+opts.validMimeTypes),!1)}};return service}function onReadFileDirective(fileRead){return{restrict:"A",scope:{onReadFile:"&",validMimeTypes:"@accept",maxFileSize:"@"},link:function(scope,element){return element.on("change",function(event){null!==event&&event.preventDefault();for(var files=(event.srcElement||event.target).files,i=0;i<files.length;i++)fileRead.processFile(files[i],scope)})}}}function fileDropzoneDirective(fileRead){return{restrict:"A",scope:{onReadFile:"&dropped",validMimeTypes:"@fileDropzone",maxFileSize:"@"},link:function(scope,element){function processDragOverOrEnter(event){return null!==event&&event.preventDefault(),element.addClass("hover"),(event.dataTransfer||event.originalEvent.dataTransfer).effectAllowed="copy",!1}function processDragLeave(event){return null!==event&&event.preventDefault(),element.removeClass("hover"),!1}return element.bind("dragover",processDragOverOrEnter),element.bind("dragenter",processDragOverOrEnter),element.bind("dragleave",processDragLeave),element.bind("drop",function(event){null!==event&&event.preventDefault(),element.removeClass("hover");for(var files=(event.dataTransfer||event.originalEvent.dataTransfer).files,i=0;i<files.length;i++){var file=files[i];fileRead.processFile(file,scope)}return!1})}}}var angular,dp;return _export("fileReadService",fileReadService),{setters:[function(_angular){angular=_angular.default},function(_commonServicesDatapackageDatapackage){dp=_commonServicesDatapackageDatapackage.default}],execute:function(){fileReadService.$inject=["$log","growl"],onReadFileDirective.$inject=["fileRead"],fileDropzoneDirective.$inject=["fileRead"],_export("default",angular.module("projectX.fileDrop",["angular-growl"]).service("fileRead",fileReadService).directive("onReadFile",onReadFileDirective).directive("fileDropzone",fileDropzoneDirective).name)}}}),System.register("common/directives/file-download.js",["angular","FileSaver/FileSaver.js","blobjs/Blob.js"],function(_export,_context){"use strict";var angular,saveAs,module;return{setters:[function(_angular){angular=_angular.default},function(_FileSaverFileSaverJs){saveAs=_FileSaverFileSaverJs.default},function(_blobjsBlobJs){}],execute:function(){module=angular.module("projectX.fileDownload",[]).directive("fileDownload",function(){return{scope:{file:"=fileDownload"},link:function(scope,element){function download(file){var mime=file.type||"text/plain",type=mime+";charset=utf-8",filename=file.name||"download.txt",blob=new Blob([file.content],{type:type});saveAs(blob,filename)}element.bind("click",function(){download(scope.file)})}}}),_export("default",module.name)}}}),System.register("common/services/datapackage/resolver.js",["angular"],function(_export,_context){"use strict";var angular;return _export("default",function(route){var hasDatapackageResolve=angular.isDefined(route.resolve)&&angular.isDefined(route.resolve.dataPackage);return hasDatapackageResolve||(angular.isDefined(route.datapackage)?(route.resolve=route.resolve||{},angular.extend(route.resolve,{dataPackage:["$route","dataService",function($route,dataService){var datapackage="function"==typeof route.datapackage?route.datapackage($route.current.params):route.datapackage,base=datapackage.base||route.datapackageUrl;return dataService.processPackage(base,datapackage)}]})):angular.isDefined(route.datapackageUrl)&&(route.resolve=route.resolve||{},angular.extend(route.resolve,{dataPackage:["$route","dataService",function($route,dataService){var datapackageUrl="function"==typeof route.datapackageUrl?route.datapackageUrl($route.current.params):route.datapackageUrl;return dataService.loadPackage(datapackageUrl)}]}))),route}),{setters:[function(_angular){angular=_angular.default}],execute:function(){}}}),System.register("common/services/datapackage/dataservice.js",["npm:systemjs-plugin-babel@0.0.12/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.12/babel-helpers/asyncToGenerator.js","mobx","./datapackage"],function(_export,_context5){"use strict";function run($http){dp.loader.fetch=function(url){return $http({url:url,method:"GET",cache:!1,transformResponse:function(data){return data}}).then(function(res){return res.data})}}function dataservice($log,growl){function __processResource(resource){var processed=toJS(Object.assign({},resource,{$error:null,errors:[],data:[]}));try{processed=dp.processor.resource(processed),processed.errors&&processed.errors.length>0&&(processed.$error=new Error("Errors processing resource "+processed.name))}catch(err){processed.$error=err,processed.errors=processed.errors||[],
processed.errors.shift({code:"Parsing",type:err.name,message:"Parsing error: "+err.message})}return processed.$error||processed.errors.length>0?(resource.errors=processed.errors,resource.$error=processed.$error,resource.$error.message=resource.name,resource.$valid=!1,dataservice.warn(resource.$error,{title:"Error processing resource"})):(resource.errors=[],resource.$error=null,resource.data=processed.data,resource.$lastValidContent=toJS(resource.content)),resource}function __normalizePackage(url,datapackage){return 2===arguments.length?Object.assign(datapackage,{url:url}):datapackage=url,dp.normalizePackage(datapackage)}function makePackage(datapackage){return isObservable(datapackage)?datapackage:(datapackage=new Package(datapackage),autorun(function(){datapackage.resources.forEach(function(resource){if(resource.errors&&resource.errors.length>0)return dataservice.error("Errors processing resource "+resource.name,{title:"Error processing DataPackage"})})}),datapackage)}DEBUG&&!function(){var processResource=dp.processor.resource.bind(dp.processor);dp.processor.resource=function(resource){console.time(resource.name),$log.debug("Processing",resource.name);var r=processResource(resource);return console.timeEnd(resource.name),r};var index=dp.Normalizer.index.bind(dp.Normalizer);dp.Normalizer.index=function(datapackage){return $log.debug("Re-indexing",datapackage.name),index(datapackage)}}();var dataservice={dp:dp,normalize:dp.normalize,mime:dp.normalize.mime,translators:dp.processor.translators,index:dp.Normalizer.index,warn:function(err,opts){$log.warn(err),growl.warning(err.message||String(err),opts)},error:function(err,opts){return $log.error(err),growl.error(err.message||String(err),opts),Promise.reject(err)},loadPackage:function(datapackage){var _this=this;return _asyncToGenerator(_regeneratorRuntime.mark(function _callee(){var msg;return _regeneratorRuntime.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,transaction(function(){return makePackage(datapackage).load()});case 3:return _context.abrupt("return",_context.sent);case 6:return _context.prev=6,_context.t0=_context.catch(0),msg=_context.t0.status?_context.t0.statusText+"; "+_context.t0.data:String(_context.t0),_context.abrupt("return",dataservice.error(msg,{title:"Error loading DataPackage"}));case 10:case"end":return _context.stop()}},_callee,_this,[[0,6]])}))()},processPackage:function(url,datapackage){var _this2=this;return _asyncToGenerator(_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,makePackage(url).update(datapackage);case 2:return _context2.abrupt("return",_context2.sent);case 3:case"end":return _context2.stop()}},_callee2,_this2)}))()},loadResource:function(datapackage,res){var _this3=this;return _asyncToGenerator(_regeneratorRuntime.mark(function _callee3(){var msg;return _regeneratorRuntime.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,_context3.next=3,transaction(function(){return makeResource(datapackage,res).load()});case 3:return _context3.abrupt("return",_context3.sent);case 6:return _context3.prev=6,_context3.t0=_context3.catch(0),msg=_context3.t0.status?_context3.t0.statusText+"; "+_context3.t0.data:String(_context3.t0),_context3.abrupt("return",dataservice.error(msg,{title:"Error loading resource"}));case 10:case"end":return _context3.stop()}},_callee3,_this3,[[0,6]])}))()},normalizeResource:function(p,r){return Object.assign(r,dp.normalize.resource(p,r))},processResource:__processResource,normalizePackage:__normalizePackage,reloadResource:function(resource){var _this4=this;return _asyncToGenerator(_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.prev=0,_context4.t0=Object,_context4.t1=resource,_context4.next=5,dp.loader.resource(resource);case 5:return _context4.t2=_context4.sent,_context4.t0.assign.call(_context4.t0,_context4.t1,_context4.t2),_context4.abrupt("return",dp.processResource(resource));case 10:return _context4.prev=10,_context4.t3=_context4.catch(0),$log.error(_context4.t3),_context4.abrupt("return",resource);case 14:case"end":return _context4.stop()}},_callee4,_this4,[[0,10]])}))()},makeResourceObservable:makeResource,makePackageObservable:makePackage};return dataservice}var _regeneratorRuntime,_asyncToGenerator,toJS,autorun,isObservable,transaction,dp,Package,makeResource,DEBUG;return _export("run",run),_export("dataservice",dataservice),{setters:[function(_npmSystemjsPluginBabel0012RegeneratorRuntimeJs){_regeneratorRuntime=_npmSystemjsPluginBabel0012RegeneratorRuntimeJs.default},function(_npmSystemjsPluginBabel0012BabelHelpersAsyncToGeneratorJs){_asyncToGenerator=_npmSystemjsPluginBabel0012BabelHelpersAsyncToGeneratorJs.default},function(_mobx){toJS=_mobx.toJS,autorun=_mobx.autorun,isObservable=_mobx.isObservable,transaction=_mobx.transaction},function(_datapackage){dp=_datapackage.default,Package=_datapackage.Package,makeResource=_datapackage.makeResource}],execute:function(){DEBUG=!System.production,run.$inject=["$http"],dataservice.$inject=["$log","growl"]}}}),System.register("common/services/datapackage/index.js",["angular","./resolver","./dataservice"],function(_export,_context){"use strict";var angular,addDataPackageResolver,run,dataservice,module;return{setters:[function(_angular){angular=_angular.default},function(_resolver){addDataPackageResolver=_resolver.default},function(_dataservice){run=_dataservice.run,dataservice=_dataservice.dataservice}],execute:function(){module=angular.module("projectX.dataService",["ngRoute"]).service("dataService",dataservice).run(run).decorator("$route",["$delegate",function($delegate){return angular.forEach($delegate.routes,addDataPackageResolver),$delegate}]),_export("default",module.name)}}}),System.registerDynamic("common/services/datapackage/datapackage.js",["chi-datapackage/dist/store","chi-datapackage/dist/normalizer"],!0,function($__require,exports,module){this||self;const store=$__require("chi-datapackage/dist/store"),Normalizer=$__require("chi-datapackage/dist/normalizer"),dataPackageService=store.dataPackageService;return dataPackageService.Normalizer=Normalizer,dataPackageService.Resource=store.Resource,dataPackageService.Package=store.Package,dataPackageService.makeResource=store.makeResource,dataPackageService.makePackage=store.makePackage,dataPackageService.mime=dataPackageService.normalize.mime,module.exports=dataPackageService,module.exports}),System.register("common/components/editor/editor.html!github:systemjs/plugin-text@0.0.9/text.js",[],function(_export,_context){"use strict";var __useDefault;return{setters:[],execute:function(){_export("__useDefault",__useDefault=!0),_export("__useDefault",__useDefault),_export("default",'<div ng-if="$ctrl.options.enableProtected && $ctrl.panel.open">\n  <alert close="closeAlert = true" type="warning" ng-hide="closeAlert">\n    This is your chance to play with the featured visualization.  No changes you make will be saved.\n  </alert>\n</div>\n\n<section id="datapckage-editor" class="datapckage-editor-container hidden-print" style="position: relative">\n\n  <div class="pull-right panel-toggle">\n    <button id="data-add" type="button" class="btn btn-link btn-sm" tooltip="Add new resource"\n      ng-show="$ctrl.options.enableAdd && $ctrl.panel.open"\n      ng-click="$ctrl.newFile()"\n      file-dropzone="{{$ctrl.options.types}}"\n      data-max-file-size="30"\n      dropped="$ctrl.dropped(file)">\n      <i class="fa fa-plus-square" aria-hidden="true"></i>\n    </button>\n\n    <button type="button" class="btn btn-primary btn-sm"\n      ng-click="$ctrl.play()"\n      ng-if="$ctrl.options.enableProtected">\n      Try your own data\n    </button>\n\n    <button id="data-drop" type="button" class="btn btn-primary btn-sm" tooltip="Add new resource"\n      ng-if="$ctrl.options.enableDrop"\n      file-dropzone="{{$ctrl.options.types}}"\n      data-max-file-size="30"\n      dropped="$ctrl.droppedOver($ctrl.data.resources.length - 1, file)">\n      Drop your own data here\n    </button>\n\n    <button id="toogle-panel" type="button" class="btn btn-link btn-sm" tooltip="Show/hide resources panel"\n      ng-show="$ctrl.options.enableOpen"\n      ng-click="$ctrl.tooglePanel()">\n      <i class="fa fa-cog" aria-hidden="true"></i>\n    </button>\n  </div>\n\n  <form name="userForm" ng-submit="$ctrl.submit(userForm)">\n    <uib-tabset id="dataPackageEditor" class="datapckage-editor-tab"\n      active="$ctrl.activeTab"\n      ng-show="$ctrl.panel.open"\n      ng-if="$ctrl.options.enableOpen || $ctrl.options.enableProtected">\n      <uib-tab ng-repeat="tab in $ctrl.resources track by $index" select="$ctrl.ui.refresh()">\n        <uib-tab-heading\n          file-dropzone="{{$ctrl.options.types}}"\n          data-max-file-size="30"\n          dropped="$ctrl.droppedOver($index, file)">\n          {{ $ctrl.resources.length < 7 ? tab.name : $index }}\n          <a class="close" ng-click="$ctrl.remove($index)">&nbsp;&times;</a>\n        </uib-tab-heading>\n        <div file-dropzone="{{$ctrl.options.types}}" data-max-file-size="30" dropped="$ctrl.droppedOver($index, file)">\n\n          <div class="col-xs-12 mini-well">\n            <div class="col-md-3">\n              <label class="sr-only">Filename</label>\n              <input type="text" id="label" class="form-control input-sm"\n                ng-model="tab.name" placeholder="filename"\n                ng-model-options="{ updateOn: \'submit\' }"\n                ng-change="$ctrl.rename(tab)">\n            </div>\n            <div class="col-md-3">\n              <label class="sr-only">Media Type</label>\n              <select class="form-control input-sm"\n                ng-options="value as value for value in $ctrl.options.types"\n                ng-model="tab.mediatype"\n                ng-model-options="{ updateOn: \'submit\' }"\n                xxx-change="$ctrl.change(tab)"></select>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-xs-12">\n              <textarea class="editor"\n                resource="tab"\n                name="input{{$index}}"\n                ui-codemirror\n                ng-model="tab.content"\n                ng-model-options="{ updateOn: \'submit\', debounce: 200, getterSetter: false }"\n                xxx-change="$ctrl.change(tab, userForm[\'input\' + $index])"\n                ui-codemirror-opts="{\n                  lineNumbers: true,\n                  lineWrapping: false,\n                  allowDropFileTypes: false,\n                  mode: tab.format,\n                  onLoad: $ctrl.ui.codemirrorLoaded\n                }"\n                ui-refresh="$ctrl.ui.count"\n                >\n              </textarea>\n                <div class="col-xs-12 bg-danger">\n                  <ul class="list-unstyled">\n                    <li ng-repeat="error in tab.errors | limitTo:10">\n                      <span ng-if="error.row >= 0">row {{error.row}}: </span>{{error.message}}\n                    </li>\n                  </ul>\n                </div>\n            </div>\n          </div>\n        </div>\n      </uib-tab>\n    </uib-tabset>\n\n    <ng-transclude></ng-transclude>\n\n    <div class="btn-toolbar" role="toolbar" aria-label="toolbar">\n      <div id="data-download" class="btn-group" uib-dropdown>\n        <button type="button" class="btn btn-primary btn-sm dropdown-toggle" uib-dropdown-toggle aria-expanded="false" ng-if="$ctrl.options.enableFileDownload">\n          <div class="pull-right">\n            <i class="fa fa-arrow-circle-o-down" aria-hidden="true"></i>\n            Download Data <span class="caret"></span>\n          </div>\n        </button>\n        <ul class="dropdown-menu" role="menu">\n          <li class="dropdown-header">Data Resources</li>\n          <li ng-repeat="file in $ctrl.resources" ng-hide="file.hide">\n            <a class="btn btn-link" file-download="file" title="{{file.description}}">{{file.name}}</a>\n          </li>\n        </ul>\n      </div>\n\n      <div id="svg-download" class="btn-group hidden-print"\n        uib-dropdown svg-download-dropdown="svgList in #charts"\n        ng-if="$ctrl.options.enableSvgDownload || $ctrl.options.enablePngDownload">\n        <button type="button" class="btn btn-primary btn-sm dropdown-toggle"\n          uib-dropdown-toggle aria-expanded="false">\n          <div class="pull-right">\n            <i class="fa fa-picture-o" aria-hidden="true"></i>\n            Download SVG <span class="caret"></span>\n          </div>\n        </button>\n        <ul class="dropdown-menu" role="menu">\n          <li ng-repeat-start="svg in svgList" ng-show="$ctrl.options.enableSvgDownload">\n            <a href svg-download="#{{svg.id}}" title="{{svg.title}}">{{svg.title}} as SVG</a>\n          </li>\n          <li ng-repeat-end ng-show="$ctrl.options.canDownloadPng">\n            <a href svg-download="#{{svg.id}}" title="{{svg.title}}" type="png">{{svg.title}} as PNG</a>\n          </li>\n        </ul>\n      </div>\n\n      <div class="pull-right btn-toolbar" ng-show="$ctrl.panel.open">\n        <button type="submit" class="btn btn-primary btn-sm">Apply changes</button>\n        <button class="btn btn-danger btn-sm"\n          ng-click="$ctrl.cancel(userForm)">Cancel</button>\n      </div>\n    </div>\n  </form>\n</section>\n')}}}),System.register("common/components/editor/editor-controller.js",["npm:systemjs-plugin-babel@0.0.12/babel-helpers/extends.js","mobx"],function(_export,_context){"use strict";function controller($scope,$cookies,$timeout,$log,growl,dataservice){function cancel(form){$log.debug("cancel"),form.$rollbackViewValue(),hasPackage?$ctrl.resources=$ctrl.options.data.resources.slice():$ctrl.resources=[],form.$setPristine()}function submit(form){form.$valid&&($log.debug("submit"),hasPackage&&(isObservable($ctrl.options.data.resources)?$ctrl.options.data.replaceResources($ctrl.resources):($ctrl.options.data.resources=$ctrl.resources,$ctrl.options.data.$resourcesByName=$ctrl.options.data.resourcesByName=dataservice.index($ctrl.options.data))),$timeout(function(){$ctrl.options.onChange()}))}function createNewResource(name){var content=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return name=name||"new."+$ctrl.options.defaultFormat,{path:name,name:name,mediatype:dataservice.mime.lookup(name),content:content,schema:$ctrl.options.defaultSchema}}function fileDroppedOver($index,file){$log.debug("fileDroppedOver",$index,file);var resource=createNewResource(file.name,file.content);$ctrl.activeTab=$index,$ctrl.resources[$index]=resource,$ctrl.ui.refresh()}function fileDropped(file){$log.debug("fileDropped",file),addResource(file.name,file.content)}function addResource(name){var content=arguments.length<=1||void 0===arguments[1]?"":arguments[1];$log.debug("addResource",name,content);var resource=createNewResource(name,content);return $ctrl.resources.push(resource),$timeout(function(){$ctrl.ui.refresh(),$ctrl.activeTab=$ctrl.resources.length-1}),!1}function play(){tooglePanel()}function removeResourceByIndex(i){i>-1&&$ctrl.resources.splice(i,1)}function tooglePanel(){$ctrl.panel.open=!$ctrl.panel.open,$ctrl.ui.refresh(),$timeout($ctrl.ui.refresh,100)}var $ctrl=this,hasOptions=Boolean($ctrl.options),hasPackage=hasOptions&&Boolean($ctrl.options.data),hasResources=hasPackage&&$ctrl.options.data.resources.length>0,isSafari=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),isIE="undefined"!=typeof window.navigator.msSaveBlob,enableFileDownload=hasPackage&&hasResources;return $scope.$ctrl.options=$ctrl.options||{},Object.assign($ctrl.options,_extends({enableOpen:hasPackage,enableFileDownload:enableFileDownload,enableSvgDownload:!0,enablePngDownload:!isSafari&&!isIE,enableAdd:!0,enableDrop:!1,enableProtected:!1,types:Object.keys(dataservice.translators),defaultFormat:hasResources?$ctrl.options.data.resources[0].format:"txt",defaultSchema:hasResources?$ctrl.options.data.resources[0].schema:void 0,onChange:function(){}},$ctrl.options)),Object.assign($ctrl,{activeTab:0,resources:hasResources?$ctrl.options.data.resources.slice():[],panel:{open:!1},remove:removeResourceByIndex,newFile:addResource,dropped:fileDropped,droppedOver:fileDroppedOver,submit:submit,cancel:cancel,tooglePanel:tooglePanel,play:play,ui:{refresh:function(){$ctrl.ui.count++},count:0,codemirrorLoaded:function(cm){$timeout(function(){cm.refresh(),$ctrl.ui.refresh()},100)}}})}var _extends,isObservable;return _export("default",controller),{setters:[function(_npmSystemjsPluginBabel0012BabelHelpersExtendsJs){_extends=_npmSystemjsPluginBabel0012BabelHelpersExtendsJs.default},function(_mobx){isObservable=_mobx.isObservable}],execute:function(){controller.$inject=["$scope","$cookies","$timeout","$log","growl","dataService"]}}}),System.register("common/components/editor/editor.js",["angular","ui-codemirror","codemirror/lib/codemirror","codemirror/lib/codemirror.css!","./editor.less!","common/directives/svg-download-dropdown","common/directives/file-drop","common/directives/file-download","common/services/datapackage/index","common/services/datapackage/datapackage","./editor.html!text","./editor-controller"],function(_export,_context){"use strict";var angular,svgDropdownDownload,fileDrop,fileDownload,dataServices,template,controller,editor;return{setters:[function(_angular){angular=_angular.default},function(_uiCodemirror){},function(_codemirrorLibCodemirror){},function(_codemirrorLibCodemirrorCss){},function(_editorLess){},function(_commonDirectivesSvgDownloadDropdown){svgDropdownDownload=_commonDirectivesSvgDownloadDropdown.default},function(_commonDirectivesFileDrop){fileDrop=_commonDirectivesFileDrop.default},function(_commonDirectivesFileDownload){fileDownload=_commonDirectivesFileDownload.default},function(_commonServicesDatapackageIndex){dataServices=_commonServicesDatapackageIndex.default},function(_commonServicesDatapackageDatapackage){},function(_editorHtmlText){template=_editorHtmlText.default},function(_editorController){controller=_editorController.default}],execute:function(){editor=angular.module("projectX.dataEditor",["ui.codemirror",dataServices,svgDropdownDownload,fileDrop,fileDownload]).directive("datapackageEdit",function(){return{restrict:"A",scope:{},bindToController:{options:"=?datapackageEdit"},controller:controller,controllerAs:"$ctrl",transclude:!0,template:template}}).component("packageEditor",{template:template,controller:controller,transclude:!0,bindings:{options:"=?"}}),_export("default",editor.name)}}}),System.register("common/services/loading-bar/loading-bar.html!github:systemjs/plugin-text@0.0.9/text.js",[],function(_export,_context){"use strict";var __useDefault;return{setters:[],execute:function(){_export("__useDefault",__useDefault=!0),_export("__useDefault",__useDefault),_export("default",'<div id="loading-bar-spinner" class="text-center">\n  <div class="spinner-box">\n    <div class="spinner-icon"></div>\n  </div>\n</div>\n')}}}),System.register("common/services/loading-bar/loading-bar.js",["angular","angular-loading-bar","angular-loading-bar/build/loading-bar.css!","./loading-bar.less!","./loading-bar.html!text"],function(_export,_context){"use strict";var angular,spinnerTemplate,mod;return{setters:[function(_angular){angular=_angular.default},function(_angularLoadingBar){},function(_angularLoadingBarBuildLoadingBarCss){},function(_loadingBarLess){},function(_loadingBarHtmlText){spinnerTemplate=_loadingBarHtmlText.default}],execute:function(){mod=angular.module("projectX.loading-bar",["angular-loading-bar"]).config(["cfpLoadingBarProvider",function(cfpLoadingBarProvider){cfpLoadingBarProvider.latencyThreshold=32,cfpLoadingBarProvider.spinnerTemplate=spinnerTemplate}]).run(["$rootScope","cfpLoadingBar",function($rootScope,cfpLoadingBar){$rootScope.$on("$routeChangeStart",function(){cfpLoadingBar.start()}),$rootScope.$on("$routeChangeError",function(){cfpLoadingBar.complete()}),$rootScope.$on("$routeChangeSuccess",function(){cfpLoadingBar.complete()})}]),_export("default",mod.name)}}}),System.register("common/services/dynamic-title/dynamic-title.js",["angular"],function(_export,_context){"use strict";function setupRouteChange($rootScope,dynamicTitle){$rootScope.$on("$routeChangeSuccess",function(event,current){return dynamicTitle.fromState(current)})}function DynamicTitleProvider(){function DynamicTitle($document,$log){function set(title){title=title||configuration.defaultTitle,$log.debug("title set to",title),$document[0].title=title}return{set:set,fromState:function($state){var value=null;$state.$$route&&$state.$$route.title&&(value="function"==typeof $state.$$route.title?$state.$$route.title($state.params):$state.$$route.title),set(value)}}}var configuration={defaultTitle:document.title||"Project-χ"};this.configure=function(value){angular.extend(configuration,value)},this.$get=DynamicTitle,DynamicTitle.$inject=["$document","$log"]}var angular,module;return{setters:[function(_angular){angular=_angular.default}],execute:function(){module=angular.module(name,[]).provider("dynamicTitle",DynamicTitleProvider).run(setupRouteChange),_export("default",module.name),setupRouteChange.$inject=["$rootScope","dynamicTitle"],DynamicTitleProvider.$inject=[]}}}),System.register("common/services/growl/growl.js",["angular-growl/build/angular-growl.js","angular-growl/build/angular-growl.css!","angular"],function(_export,_context){"use strict";function runGrowl($rootScope,$location,growl){$rootScope.$on("$routeChangeError",function(event,curr,prev,rej){return"string"!=typeof rej&&(rej=rej.status&&rej.statusText?rej.status+" "+rej.statusText:rej.message?rej.message:String(rej)),growl.error(rej,{title:"Failed to change routes"})})}var angular,mod;return{setters:[function(_angularGrowlBuildAngularGrowlJs){},function(_angularGrowlBuildAngularGrowlCss){},function(_angular){angular=_angular.default}],execute:function(){mod=angular.module("projectX.growl",["angular-growl"]).run(runGrowl),_export("default",mod.name),runGrowl.$inject=["$rootScope","$location","growl"]}}}),System.register("common/directives/resize.js",["angular"],function(_export,_context){"use strict";function onResize($window,$timeout){return{scope:{onResize:"&"},link:function(scope){function debounceRedraw(){timeout&&$timeout.cancel(timeout),timeout=$timeout(function(){scope.onResize()},500)}function resize(){scope.onResize()}var timeout=null;angular.element($window).on("resize",debounceRedraw),"matchMedia"in window&&window.matchMedia("print").addListener(resize),scope.$on("$destroy",function(){angular.element($window).off("resize",debounceRedraw),"matchMedia"in window&&window.matchMedia("print").removeListener(resize)})}}}var angular,module;return{setters:[function(_angular){angular=_angular.default}],execute:function(){module=angular.module("projectX.onResize",[]).directive("onResize",onResize),_export("default",module.name),onResize.$inject=["$window","$timeout"]}}}),System.register("common/directives/active-path.js",["angular"],function(_export,_context){"use strict";function activePathDirective($log,$location){return{link:function(scope,element,attrs){var re=new RegExp(attrs.activePath);scope.$watch(function(){return $location.path()},function(value){re.test(value)?element.addClass("active"):element.removeClass("active")})}}}var angular,activePath;return{setters:[function(_angular){angular=_angular.default}],execute:function(){activePath=angular.module("projectX.activePath",[]).directive("activePath",activePathDirective),_export("default",activePath.name),activePathDirective.$inject=["$log","$location"]}}}),System.register("common/common.js",["angular","common/services/datapackage/index","common/components/editor/editor","common/services/loading-bar/loading-bar","common/services/dynamic-title/dynamic-title","common/services/growl/growl","common/directives/resize","common/directives/active-path"],function(_export,_context){"use strict";var angular,dataServices,dataPackageEditor,loadingBar,dynamicTitle,growl,onResize,activePath,common;return{setters:[function(_angular){angular=_angular.default},function(_commonServicesDatapackageIndex){dataServices=_commonServicesDatapackageIndex.default},function(_commonComponentsEditorEditor){dataPackageEditor=_commonComponentsEditorEditor.default},function(_commonServicesLoadingBarLoadingBar){loadingBar=_commonServicesLoadingBarLoadingBar.default},function(_commonServicesDynamicTitleDynamicTitle){dynamicTitle=_commonServicesDynamicTitleDynamicTitle.default},function(_commonServicesGrowlGrowl){growl=_commonServicesGrowlGrowl.default},function(_commonDirectivesResize){onResize=_commonDirectivesResize.default},function(_commonDirectivesActivePath){activePath=_commonDirectivesActivePath.default}],execute:function(){common=angular.module("projectX.common",[dataServices,dataPackageEditor,onResize,loadingBar,dynamicTitle,growl,activePath]),_export("default",common.name)}}}),System.register("common/partials/footer.html!github:systemjs/plugin-text@0.0.9/text.js",[],function(_export,_context){"use strict";var __useDefault;return{setters:[],execute:function(){_export("__useDefault",__useDefault=!0),_export("__useDefault",__useDefault),_export("default",'<div class="container">\n\t<p>Website designed and built at RIKEN, Japan.</p>\n\t<p>Code licensed under MIT</p>\n\t<p>DEIVA v1.0.1\n\t<p>\n\t\t<a href="https://github.com/Hypercubed/DEIVA">Source</a>\n\t\t// <a ng-href="#/about">About</a>\n\t\t// <a href="https://github.com/Hypercubed/DEIVA/issues">Issues</a></p>\n</div>\n')}}}),System.register("components/app.component.js",["common/partials/footer.html!text"],function(_export,_context){"use strict";var footerHTML,AppComponent;return{setters:[function(_commonPartialsFooterHtmlText){footerHTML=_commonPartialsFooterHtmlText.default}],execute:function(){AppComponent={template:'\n    <div class="container-fluid">\n      <div ng-view autoscroll class="ng-fade"></div>\n    </div>\n\n    <div class="footer">\n      '+footerHTML+"\n    </div>\n\n    <div growl></div>"},_export("default",AppComponent)}}}),System.register("components/app.js",["./app.css!","angular","angular-route","angular-animate","angular-cookies","angular-sanitize","angular-touch","angular-ui-bootstrap","angular-marked","components/routes","common/common","./app.component"],function(_export,_context){"use strict";var angular,angularMarked,routes,common,AppComponent;return{setters:[function(_appCss){},function(_angular){angular=_angular.default},function(_angularRoute){},function(_angularAnimate){},function(_angularCookies){},function(_angularSanitize){},function(_angularTouch){},function(_angularUiBootstrap){},function(_angularMarked){angularMarked=_angularMarked.default},function(_componentsRoutes){routes=_componentsRoutes.default},function(_commonCommon){common=_commonCommon.default},function(_appComponent){AppComponent=_appComponent.default}],execute:function(){_export("default",angular.module("projectX",["ngRoute","ngAnimate","ngCookies","ngSanitize","ngTouch","ui.bootstrap",angularMarked,routes.name||routes,common]).component("app",AppComponent).config(["$logProvider","$compileProvider",function($logProvider,$compileProvider){$logProvider.debugEnabled(!System.production),$compileProvider.debugInfoEnabled(!System.production)}]).config(["$animateProvider",function($animateProvider){$animateProvider.classNameFilter(/ng-animate-enabled/)}]))}}}),System.register("components/boot.js",["webcomponentsjs/webcomponents-lite.js","core-js/client/shim","FileSaver/FileSaver.js","bootstrap/less/bootstrap.less!","font-awesome/less/font-awesome.less!","angular","./app"],function(_export,_context){"use strict";var saveAs,angular,app;return{setters:[function(_webcomponentsjsWebcomponentsLiteJs){},function(_coreJsClientShim){},function(_FileSaverFileSaverJs){saveAs=_FileSaverFileSaverJs.default},function(_bootstrapLessBootstrapLess){},function(_fontAwesomeLessFontAwesomeLess){},function(_angular){angular=_angular.default},function(_app){app=_app.default}],execute:function(){window.saveAs=saveAs,angular.element(document).ready(function(){angular.bootstrap(document.body,[app.name],{strictDi:!0})})}}});
//# sourceMappingURL=app-bundle.js.map